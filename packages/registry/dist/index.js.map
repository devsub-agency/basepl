{"version":3,"sources":["../src/index.ts","../package.json","../src/commands/add.ts","../src/utils/logging/logger.ts","../src/utils/registry/componentsFilter.ts","../src/utils/registry/schema.ts","../src/utils/registry/fetchRegistry.ts","../src/utils/error/handle-error.ts","../src/utils/registry/resolveRegistryDependencies.ts","../src/utils/add/addDependencies.ts","../src/utils/getPackageManager.ts","../src/utils/spinner.ts","../src/utils/add/addFiles.ts","../src/utils/config/configHandler.ts","../src/utils/add/addComponents.ts","../src/utils/preflights/preflightAdd.ts","../src/commands/init.ts","../src/utils/initShadcn.ts","../src/utils/preflights/preflightInit.ts"],"sourcesContent":["#!/usr/bin/env node\n\nimport { Command } from \"commander\";\nimport packageJson from \"../package.json\";\nimport add from \"./commands/add\";\nimport { init } from \"./commands/init\";\n\nprocess.on(\"SIGINT\", () => process.exit(0));\nprocess.on(\"SIGTERM\", () => process.exit(0));\n\nasync function main() {\n  const program = new Command()\n    .name(\"basepl\")\n    .description(\"add fields and blocks to your payload cms project\")\n    .version(\n      packageJson.version || \"1.0.0\",\n      \"-v, --version\",\n      \"display the version number\",\n    );\n\n  program.addCommand(add).addCommand(init);\n\n  program.parse();\n}\n\nmain();\n","{\r\n  \"name\": \"@basepl/cli\",\r\n  \"version\": \"1.0.1\",\r\n  \"description\": \"Add fields and blocks to your payload cms.\",\r\n  \"publishConfig\": {\r\n    \"access\": \"public\"\r\n  },\r\n  \"license\": \"MIT\",\r\n  \"author\": {\r\n    \"name\": \"devsub\",\r\n    \"url\": \"https://devsub.de/en\"\r\n  },\r\n  \"repository\": {\r\n    \"type\": \"git\",\r\n    \"url\": \"https://github.com/devsub-agency/payloadbase\",\r\n    \"directory\": \"templates\"\r\n  },\r\n  \"files\": [\r\n    \"dist\",\r\n    \"README.md\"\r\n  ],\r\n  \"keywords\": [\r\n    \"payload\",\r\n    \"components\",\r\n    \"fields\",\r\n    \"blocks\"\r\n  ],\r\n  \"type\": \"module\",\r\n \"bin\": {\r\n    \"basepl\": \"./dist/index.js\"\r\n  },\r\n  \"exports\": {\r\n    \".\": {\r\n      \"import\": \"./dist/index.js\"\r\n    }\r\n  },\r\n  \"scripts\": {\r\n    \"dev\": \"tsup --watch\",\r\n    \"build\": \"tsup\",\r\n    \"typecheck\": \"tsc --noEmit\",\r\n    \"clean\": \"rimraf dist node_modules\",\r\n    \"start:dev\": \"cross-env REGISTRY_URL=http://localhost:3000/registry node dist/index.js\",\r\n    \"start:prod\": \"cross-env REGISTRY_URL=https://basepl.com/registry/ node dist/index.js\",\r\n    \"start\": \"node dist/index.js\",\r\n    \"format:write\": \"prettier --write \\\"**/*.{ts,tsx,mdx}\\\" --cache\",\r\n    \"format:check\": \"prettier --check \\\"**/*.{ts,tsx,mdx}\\\" --cache\",\r\n    \"pub:beta\": \"pnpm build && pnpm publish --no-git-checks --access public --tag beta\",\r\n    \"pub:next\": \"pnpm build && pnpm publish --no-git-checks --access public --tag next\",\r\n    \"pub:release\": \"pnpm build && pnpm publish --access public\",\r\n    \"test\": \"vitest run\",\r\n    \"test:dev\": \"REGISTRY_URL=http://localhost:3000/registry vitest run\"\r\n  },\r\n  \"dependencies\": {\r\n    \"chalk\": \"^5.3.0\",\r\n    \"commander\": \"^12.1.0\",\r\n    \"cosmiconfig\": \"^9.0.0\",\r\n    \"diff\": \"^7.0.0\",\r\n    \"execa\": \"^9.5.1\",\r\n    \"fast-glob\": \"^3.3.2\",\r\n    \"fs-extra\": \"^11.2.0\",\r\n    \"kleur\": \"^4.1.5\",\r\n    \"node-fetch\": \"^3.3.2\",\r\n    \"ora\": \"^8.1.1\",\r\n    \"prompts\": \"^2.4.2\",\r\n    \"ts-morph\": \"^24.0.0\",\r\n    \"tsconfig-paths\": \"^4.2.0\",\r\n    \"zod\": \"^3.23.8\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"@types/fs-extra\": \"^11.0.4\",\r\n    \"@types/lodash.template\": \"^4.5.3\",\r\n    \"@types/prompts\": \"^2.4.9\",\r\n    \"tsup\": \"8.3.5\",\r\n    \"type-fest\": \"^4.29.0\",\r\n    \"typescript\": \"^5.7.2\",\r\n    \"rimraf\": \"^5.0.0\"\r\n  }\r\n}\r\n","import { Command } from \"commander\";\nimport path from \"path\";\nimport { z } from \"zod\";\nimport { addComponents } from \"../utils/add/addComponents\";\nimport { checkInitialized } from \"../utils/config/configHandler\";\nimport { logger } from \"../utils/logging/logger\";\nimport { preFlightAdd } from \"../utils/preflights/preflightAdd\";\n\nexport const addOptionsSchema = z.object({\n  components: z.array(z.string()).optional(),\n  yes: z.boolean(),\n  overwrite: z.boolean(),\n  cwd: z.string(),\n  config: z.boolean(),\n});\n\nconst add = new Command(\"add\")\n  .description(\"add fields and blocks to your payload cms project\")\n  .argument(\"[components...]\", \"the fields and blocks to add.\")\n  .option(\"-y, --yes\", \"skip confirmation prompt.\", true)\n  .option(\"-o, --overwrite\", \"overwrite existing files.\", false)\n  .option(\n    \"-c, --cwd <cwd>\",\n    \"the working directory. defaults to the current directory.\",\n    process.cwd(),\n  )\n  .option(\"--config\", \"only add the config.ts without component\", false)\n  .action(async (comp, opt) => {\n    try {\n      const options = addOptionsSchema.parse({\n        components: comp,\n        cwd: path.resolve(opt.cwd),\n        ...opt,\n      });\n      const isInitialized = await checkInitialized(options.cwd);\n      if (!isInitialized) {\n        logger.error(\n          \"Project is not initialized. Please run 'payloadbase init' first\",\n        );\n        process.exit(0);\n      }\n\n      if (!options.components?.length) {\n        logger.error(\"Provide at least one field or block to install!\");\n        process.exit(0);\n      }\n      preFlightAdd(options);\n\n      await addComponents(options.components, options);\n    } catch (error) {\n      logger.error(\"An error occurred while adding the field:\", error);\n      process.exit(1);\n    }\n  });\n\nexport default add;\n","import { red, white, green, yellow } from \"kleur/colors\";\n\nexport const loggingColor = {\n  error: red,\n  warn: yellow,\n  info: white,\n  success: green,\n};\n\nexport const logger = {\n  error(...args: unknown[]) {\n    console.log(loggingColor.error(args.join(\" \")));\n  },\n  warn(...args: unknown[]) {\n    console.log(loggingColor.warn(args.join(\" \")));\n  },\n  info(...args: unknown[]) {\n    console.log(loggingColor.info(args.join(\" \")));\n  },\n  success(...args: unknown[]) {\n    console.log(loggingColor.success(args.join(\" \")));\n  },\n  log(...args: unknown[]) {\n    console.log(args.join(\" \"));\n  },\n  break() {\n    console.log(\"\");\n  },\n};\n","import { z } from \"zod\";\nimport { registryIndexSchema } from \"./schema\";\n\nconst filterComponentsResultSchema = z.object({\n  found: z.array(registryIndexSchema.element),\n  notFound: z.array(z.string()),\n});\n\ntype FilterComponentsResult = z.infer<typeof filterComponentsResultSchema>;\n\nexport const filterRequestedComponents = (\n  registry: z.infer<typeof registryIndexSchema>,\n  requestedComponents: string[],\n): FilterComponentsResult => {\n  const result = filterComponentsResultSchema.parse({\n    found: [],\n    notFound: [],\n  });\n\n  requestedComponents.forEach((requested) => {\n    const component = registry.find(\n      (item) => item.name.toLowerCase() === requested.toLowerCase(),\n    );\n\n    if (component) {\n      result.found.push(component);\n    } else {\n      result.notFound.push(requested);\n    }\n  });\n\n  return result;\n};\n","import { z } from \"zod\";\n\nexport const registryFileSchemaType = z.enum([\n  \"templates/fields\",\n  \"templates/blocks\",\n  \"templates/components\",\n]);\n\nexport const registryItemFileSchema = z.object({\n  path: z.string(),\n  content: z.string().optional(),\n  type: registryFileSchemaType,\n});\n\n/**\n * In the index.json we list every file contained in a folder. The representation of files is always a folder in the registry.\n * When we fetch the content from the registry these files are all seperated as individual items. The structure is the same as later in the project.\n */\nexport const registryItemSchema = z.object({\n  name: z.string(),\n  type: registryFileSchemaType,\n  file: registryItemFileSchema,\n});\n\nexport const registryIndexFileItem = z.object({\n  path: z.string(),\n  type: registryFileSchemaType,\n});\n\nexport const registryIndexItem = z.object({\n  name: z.string(),\n  type: registryFileSchemaType,\n  dependencies: z.array(z.string()).optional(),\n  registryDependencies: z.array(z.string()).optional(),\n  files: z.array(registryIndexFileItem),\n});\nexport type RegistryFile = z.infer<typeof registryIndexFileItem>;\n\nexport type RegistryItem = z.infer<typeof registryIndexItem>;\n\nexport const registryIndexSchema = z.array(registryIndexItem);\n","import path from \"path\";\nimport handleError from \"../error/handle-error\";\nimport { logger } from \"../logging/logger\";\nimport { registryIndexSchema } from \"./schema\";\n\nconst REGISTRY_URL = process.env.REGISTRY_URL ?? \"https://basepl.com/registry\";\n\nexport const getRegistryIndex = async () => {\n  try {\n    const result = await fetchRegistry(\"index.json\");\n    return registryIndexSchema.parse(result);\n  } catch (e) {\n    logger.error(\"\\n\");\n    handleError(e);\n  }\n};\n\nexport const fetchRegistry = async (path: string) => {\n  try {\n    const result = await fetch(getRegistryUrl(path));\n    if (!result.ok) {\n      throw new Error(`Failed to fetch registry: ${result.statusText}`);\n    }\n    return result.json();\n  } catch (e) {\n    logger.error(\"\\n\");\n    handleError(e);\n    return null;\n  }\n};\n\nconst getRegistryUrl = (path: string) => {\n  if (!path.endsWith(\".json\")) {\n    path = replaceExtensionWithJson(path);\n  }\n  return `${REGISTRY_URL}/${path}`;\n};\n\nconst replaceExtensionWithJson = (filePath: string): string => {\n  if (filePath.endsWith(\".json\")) return filePath;\n\n  const parsedPath = path.parse(filePath);\n  return path.format({\n    ...parsedPath,\n    base: undefined,\n    ext: \".json\",\n  });\n};\n","import { z } from \"zod\";\nimport { logger, loggingColor } from \"@/src/utils/logging/logger\";\n\nconst handleError = (error: unknown) => {\n  logger.error(\n    `Something went wrong. Please check the error below for more details.`,\n  );\n  logger.error(`If the problem persists, please open an issue on GitHub.`);\n  logger.error(\"\");\n  if (typeof error === \"string\") {\n    logger.error(error);\n    logger.break();\n    process.exit(1);\n  }\n\n  if (error instanceof z.ZodError) {\n    logger.error(\"Validation failed:\");\n    for (const [key, value] of Object.entries(error.flatten().fieldErrors)) {\n      logger.error(`- ${loggingColor.info(key)}: ${value}`);\n    }\n    logger.break();\n    process.exit(1);\n  }\n\n  if (error instanceof Error) {\n    logger.error(error.message);\n    logger.break();\n    process.exit(1);\n  }\n\n  logger.break();\n  process.exit(1);\n};\n\nexport default handleError;\n","import { RegistryItem } from \"./schema\";\n\nexport const resolveRegistryDependencies = async (\n  items: RegistryItem[],\n  registryIndex: RegistryItem[],\n): Promise<RegistryItem[]> => {\n  const resolved = new Set<string>(); // Track processed items\n  const result: RegistryItem[] = []; // Store final list\n\n  const resolveDependencies = (item: RegistryItem) => {\n    if (resolved.has(item.name)) {\n      return;\n    }\n    resolved.add(item.name);\n    if (item.registryDependencies?.length) {\n      item.registryDependencies.forEach((depName) => {\n        const dependency = registryIndex.find((reg) => reg.name === depName);\n        if (dependency) {\n          resolveDependencies(dependency);\n        }\n      });\n    }\n    result.push(item);\n  };\n  items.forEach((item) => resolveDependencies(item));\n  return result;\n};\n","import path from \"path\";\nimport { getPackageManager } from \"../getPackageManager\";\nimport { RegistryItem } from \"../registry/schema\";\nimport { spinner } from \"../spinner\";\nimport fse from \"fs-extra\";\nimport { type PackageJson } from \"type-fest\";\nimport { logger } from \"../logging/logger\";\nimport prompts from \"prompts\";\nimport { execa } from \"execa\";\n\nexport const addDependencies = async (\n  cwd: string,\n  dependencies: RegistryItem[\"dependencies\"],\n) => {\n  if (!dependencies?.length) {\n    return;\n  }\n  const dependenciesSpinner = spinner(`Installing dependencies.`).start();\n  const packageManager = await getPackageManager({\n    options: null,\n    projectDir: cwd,\n  });\n  let flag = \"\";\n  if (isUsingReact19(cwd) && packageManager === \"npm\") {\n    dependenciesSpinner.stopAndPersist();\n    logger.warn(\n      \"\\nIt looks like you are using React 19. \\nSome packages may fail to install due to peer dependency issues in npm (see https://ui.shadcn.com/react-19).\\n\",\n    );\n    const confirmation = await prompts([\n      {\n        type: \"select\",\n        name: \"flag\",\n        message: \"How would you like to proceed?\",\n        choices: [\n          { title: \"Use --force\", value: \"force\" },\n          { title: \"Use --legacy-peer-deps\", value: \"legacy-peer-deps\" },\n        ],\n      },\n    ]);\n\n    if (confirmation) {\n      flag = confirmation.flag;\n    }\n  }\n  dependenciesSpinner?.start();\n  await execa(\n    packageManager,\n    [\n      packageManager === \"npm\" ? \"install\" : \"add\",\n      ...(packageManager === \"npm\" && flag ? [`--${flag}`] : []),\n      ...dependencies,\n    ],\n    {\n      cwd: cwd,\n    },\n  );\n  dependenciesSpinner?.succeed();\n};\n\nconst isUsingReact19 = (cwd: string) => {\n  const packageJsonPath = path.join(cwd, \"package.json\");\n  const packageJson = fse.readJSONSync(packageJsonPath, {\n    throws: true,\n  }) as PackageJson;\n\n  if (!packageJson?.dependencies?.react) {\n    return false;\n  }\n\n  return /^(?:\\^|~)?19(?:\\.\\d+)*(?:-.*)?$/.test(packageJson.dependencies.react);\n};\n","import { z } from \"zod\";\nimport fse from \"fs-extra\";\nimport { execa } from \"execa\";\nimport { initOptionSchema } from \"../commands/init\";\n\nexport type PackageManager = \"npm\" | \"yarn\" | \"pnpm\" | \"bun\";\n\nexport async function getPackageManager(args: {\n  options: z.infer<typeof initOptionSchema> | null;\n  projectDir: string;\n}): Promise<PackageManager> {\n  const { options, projectDir } = args;\n\n  try {\n    // Check for flag or lockfile\n    let detected: PackageManager = \"npm\";\n    if (options?.pnpm || fse.existsSync(`${projectDir}/pnpm-lock.yaml`)) {\n      detected = \"pnpm\";\n    } else if (options?.yarn || fse.existsSync(`${projectDir}/yarn.lock`)) {\n      detected = \"yarn\";\n    } else if (\n      options?.npm ||\n      fse.existsSync(`${projectDir}/package-lock.json`)\n    ) {\n      detected = \"npm\";\n    } else if (options?.bun || fse.existsSync(`${projectDir}/bun.lockb`)) {\n      detected = \"bun\";\n    } else if (await commandExists(\"pnpm\")) {\n      // Prefer pnpm if it's installed\n      detected = \"pnpm\";\n    }\n\n    return detected;\n  } catch (ignore) {\n    return \"npm\";\n  }\n\n  async function commandExists(command: string): Promise<boolean> {\n    try {\n      process.platform === \"win32\"\n        ? await execa`where ${command}`\n        : await execa`command -v ${command}`;\n      return true;\n    } catch {\n      return false;\n    }\n  }\n}\n","import ora, { type Options } from \"ora\";\n\nexport function spinner(\n  text: Options[\"text\"],\n  options?: {\n    silent?: boolean;\n  },\n) {\n  return ora({\n    text,\n    isSilent: options?.silent,\n  });\n}\n","import { existsSync, promises as fs } from \"fs\";\nimport path, { basename, dirname } from \"path\";\nimport prompts from \"prompts\";\nimport handleError from \"../error/handle-error\";\nimport { logger, loggingColor } from \"../logging/logger\";\nimport { fetchRegistry } from \"../registry/fetchRegistry\";\nimport {\n  RegistryFile,\n  RegistryItem,\n  registryItemSchema,\n} from \"../registry/schema\";\nimport { spinner } from \"../spinner\";\nimport { ConfigFile } from \"../config/configFile\";\n\nconst getFileContent = async (file: RegistryFile): Promise<string> => {\n  try {\n    logger.info(`\\n Reading template: ${file.path}`);\n    const result = await fetchRegistry(file.path);\n    const content = registryItemSchema.parse(result).file.content;\n    if (!content) {\n      logger.error(\n        `This should not happen. Template ${file.path} is empty. Please check the registry and open an issue.`,\n      );\n      process.exit(1);\n    }\n    return content;\n  } catch (error) {\n    logger.error(`Failed to read template: ${file.path}`);\n    handleError(error);\n    return \"\";\n  }\n};\n\nexport const addFiles = async (\n  options: { cwd: string; overwrite?: boolean },\n  files: RegistryItem[\"files\"],\n  config: ConfigFile,\n) => {\n  if (!files?.length) return;\n\n  const filesCreated: string[] = [];\n  const filesUpdated: string[] = [];\n  const filesSkipped: string[] = [];\n\n  const addFileSpinner = spinner(\"Adding files change ...\").start();\n\n  try {\n    for (const file of files) {\n      const fileName = basename(file.path);\n      if (fileName.includes(\".tsx\") && !config.shadcnInstalled) {\n        logger.warn(\n          `File ${loggingColor.info(fileName)} is a component file. This project was initialized without shadcn/ui, so components are skipped.`,\n        );\n        continue;\n      }\n      const targetDir = path\n        .join(options.cwd, \"src\", file.path)\n        .replace(fileName, \"\");\n      const targetPath = path.join(targetDir, fileName);\n\n      if (existsSync(targetPath) && !options.overwrite) {\n        addFileSpinner.stop();\n        const { overwrite } = await prompts({\n          type: \"confirm\",\n          name: \"overwrite\",\n          message: `File ${loggingColor.info(basename(file.path))} exists. Overwrite?`,\n          initial: false,\n        });\n\n        if (!overwrite) {\n          filesSkipped.push(path.relative(options.cwd, targetPath));\n          addFileSpinner.start();\n          continue;\n        }\n        addFileSpinner.start();\n      }\n\n      await fs.mkdir(targetDir, { recursive: true });\n      const content = await getFileContent(file);\n      await fs.writeFile(targetPath, content, \"utf-8\");\n\n      const relativePath = path.relative(options.cwd, targetPath);\n\n      existsSync(targetPath)\n        ? filesUpdated.push(relativePath)\n        : filesCreated.push(relativePath);\n    }\n\n    addFileSpinner.succeed(\"Files added successfully\");\n\n    if (filesCreated.length) {\n      logger.info(\n        \"Created files:\\n\" + filesCreated.map((f) => `  ${f}`).join(\"\\n\"),\n      );\n    }\n    if (filesUpdated.length) {\n      logger.info(\n        \"Updated files:\\n\" + filesUpdated.map((f) => `  ${f}`).join(\"\\n\"),\n      );\n    }\n    if (filesSkipped.length) {\n      logger.info(\n        \"Skipped files:\\n\" + filesSkipped.map((f) => `  ${f}`).join(\"\\n\"),\n      );\n    }\n  } catch (error) {\n    addFileSpinner.fail(\"Failed to add files\");\n    handleError(error);\n  }\n};\n","import path from \"path\";\nimport fs from \"fs-extra\";\nimport { ConfigFile } from \"./configFile\";\n\nexport const CONFIG_FILE = \".payloadbase.json\";\n\nexport const createConfig = async (\n  cwd: string,\n  config: Partial<ConfigFile>,\n) => {\n  const defaultConfig: ConfigFile = {\n    version: \"1.0.0\",\n    initialized: true,\n    timestamp: new Date().toISOString(),\n    shadcnInstalled: false,\n    ...config,\n  };\n  await fs.writeJSON(path.join(cwd, CONFIG_FILE), defaultConfig, { spaces: 2 });\n};\n\nexport const getConfig = async (cwd: string): Promise<ConfigFile | null> => {\n  try {\n    return await fs.readJSON(path.join(cwd, CONFIG_FILE));\n  } catch {\n    return null;\n  }\n};\n\nexport const checkInitialized = async (cwd: string): Promise<boolean> => {\n  const config = await getConfig(cwd);\n  return Boolean(config?.initialized);\n};\n\nexport const defaultConfig: ConfigFile = {\n  version: \"1.0.0\",\n  initialized: true,\n  timestamp: new Date().toISOString(),\n  shadcnInstalled: false,\n};\n","import { addOptionsSchema } from \"@/src/commands/add\";\nimport { z } from \"zod\";\nimport { logger } from \"../logging/logger\";\nimport { filterRequestedComponents } from \"../registry/componentsFilter\";\nimport { getRegistryIndex } from \"../registry/fetchRegistry\";\nimport { resolveRegistryDependencies } from \"../registry/resolveRegistryDependencies\";\nimport { addDependencies } from \"./addDependencies\";\nimport { addFiles } from \"./addFiles\";\nimport { getConfig } from \"../config/configHandler\";\n\nexport const addComponents = async (\n  components: string[],\n  options: z.infer<typeof addOptionsSchema>,\n) => {\n  const registryInfo = await getRegistryIndex();\n  if (!registryInfo) {\n    logger.error(\"Failed to fetch registry\");\n    process.exit(1);\n  }\n\n  const { found, notFound } = filterRequestedComponents(\n    registryInfo,\n    components,\n  );\n\n  if (notFound.length > 0) {\n    logger.warn(`Components not found in registry: ${notFound.join(\", \")}`);\n\n    if (found.length === 0) {\n      logger.error(\"No valid components to install\");\n      process.exit(1);\n    }\n  }\n  const config = await getConfig(options.cwd);\n  if (!config) {\n    logger.error(\"Failed to read config file\");\n    process.exit(1);\n  }\n  const itemsToRegister = await resolveRegistryDependencies(\n    found,\n    registryInfo,\n  );\n\n  await addDependencies(\n    options.cwd,\n    itemsToRegister.flatMap(\n      (item) =>\n        item.dependencies?.filter((dep): dep is string => dep !== undefined) ??\n        [],\n    ),\n  );\n  await addFiles(\n    { cwd: options.cwd, overwrite: options.overwrite },\n    itemsToRegister.flatMap((item) => item.files),\n    config,\n  );\n};\n","import { addOptionsSchema } from \"../../commands/add\";\nimport { z } from \"zod\";\nimport { existsSync } from \"fs\";\nimport path from \"path\";\nimport { logger } from \"../logging/logger\";\n\nexport const preFlightAdd = (options: z.infer<typeof addOptionsSchema>) => {\n  if (\n    !existsSync(options.cwd) ||\n    !existsSync(path.resolve(options.cwd, \"package.json\"))\n  ) {\n    logger.error(\n      \"Target project does not exist or is not a valid Payload project\",\n    );\n    process.exit(0);\n  }\n};\n","import { Command } from \"commander\";\nimport path from \"path\";\nimport prompts from \"prompts\";\nimport { z } from \"zod\";\nimport {\n  CONFIG_FILE,\n  createConfig,\n  defaultConfig,\n} from \"../utils/config/configHandler\";\nimport handleError from \"../utils/error/handle-error\";\nimport { getPackageManager } from \"../utils/getPackageManager\";\nimport { initShadcn } from \"../utils/initShadcn\";\nimport { logger, loggingColor } from \"../utils/logging/logger\";\nimport {\n  checkProjectSetUp,\n  checkShadcnPresents,\n  getPayloadAppDetails,\n} from \"../utils/preflights/preflightInit\";\nimport { spinner } from \"../utils/spinner\";\n\nexport const initOptionSchema = z.object({\n  cwd: z.string(),\n  yes: z.boolean(),\n  defaults: z.boolean(),\n  npm: z.boolean().optional(),\n  bun: z.boolean().optional(),\n  yarn: z.boolean().optional(),\n  pnpm: z.boolean().optional(),\n  config: z.boolean().optional(),\n});\n\nexport const init = new Command()\n  .name(\"init\")\n  .description(\"Initialize your project and install dependencies.\")\n  .option(\n    \"-c, --cwd <cwd>\",\n    \"the working directory. defaults to the current directory.\",\n    process.cwd(),\n  )\n  .option(\"-y, --yes\", \"skip confirmation prompt.\", true)\n  .option(\"-d, --defaults,\", \"use default configuration.\", false)\n  .option(\"--npm,\", \"use npm to install dependencies\", false)\n  .option(\"--bun,\", \"use bun to install dependencies\", false)\n  .option(\"--yarn,\", \"use yarn to install dependencies\", false)\n  .option(\"--pnpm,\", \"use pnpm to install dependencies\", false)\n  .option(\n    \"--config,\",\n    `initialize in config only mode, not components can be installed.`,\n    false,\n  )\n  .action(async (o) => {\n    try {\n      const options = initOptionSchema.parse(o);\n      const payloadCheckSpinner = spinner(\"Checking project setup.\").start();\n      const isPayloadPresents = await checkProjectSetUp(options.cwd);\n      let isShadcnPresentInitialized = false;\n      if (!isPayloadPresents) {\n        payloadCheckSpinner.fail();\n        logger.error(\"Payload is not present in the project.\");\n        logger.warn(\n          `Please init the project with payload first. Use ${loggingColor.success(\"'npx create-payload-app'\")} or check out the official payload documentation.`,\n        );\n        process.exit(0);\n      }\n      payloadCheckSpinner.succeed();\n      const appDetails = await getPayloadAppDetails(options.cwd);\n      if (!appDetails.isSupportedPayloadVersion) {\n        process.exit(0);\n      }\n      if (!options.config) {\n        const packageManager = await getPackageManager({\n          options,\n          projectDir: options.cwd,\n        });\n        const isShadcnPresents = await checkShadcnPresents(options.cwd);\n        if (isShadcnPresents) {\n          isShadcnPresentInitialized = true;\n          logger.info(\"Shadcn is already present in the project.\");\n        } else {\n          logger.info(\"Shadcn is not present in the project.\");\n          if (!options.yes) {\n            const { proceed } = await prompts({\n              type: \"confirm\",\n              name: \"proceed\",\n              message:\n                \"Do you want to install shadcn/ui in the project? If not, you wont be able to install components, only config files.\",\n              initial: true,\n            });\n\n            if (proceed) {\n              await initShadcn({ cwd: options.cwd, packageManager });\n              isShadcnPresentInitialized = true;\n            } else {\n              logger.info(\n                \"Initialize in config only mode. No components will be installed.\",\n              );\n            }\n          }\n        }\n      } else {\n        logger.info(\n          \"Initialize in config only mode. No components will be installed.\",\n        );\n      }\n\n      if (!options.yes) {\n        const { proceed } = await prompts({\n          type: \"confirm\",\n          name: \"proceed\",\n          message: `Write configuration to ${loggingColor.info(\n            `${CONFIG_FILE}`,\n          )}. Proceed?`,\n          initial: true,\n        });\n\n        if (!proceed) {\n          process.exit(0);\n        }\n      }\n\n      const componentSpinner = spinner(`Writing ${CONFIG_FILE}.`).start();\n      await createConfig(options.cwd, {\n        ...defaultConfig,\n        shadcnInstalled: isShadcnPresentInitialized,\n      });\n      componentSpinner.succeed();\n\n      logger.success(\"Project is ready to install components!\");\n      logger.info(\n        `Use ${loggingColor.success(\"'add <component>'\")} to install components. For a list of available components and for further information check the documentation.`,\n      );\n    } catch (e) {\n      logger.break();\n      handleError(e);\n    }\n  });\n","import { execa } from \"execa\";\nimport { logger } from \"./logging/logger\";\nimport { PackageManager } from \"./getPackageManager\";\nimport { spinner } from \"./spinner\";\nimport handleError from \"./error/handle-error\";\n\ninterface InitShadcnProps {\n  cwd: string;\n  packageManager: PackageManager;\n}\n\nexport async function initShadcn({ cwd, packageManager }: InitShadcnProps) {\n  try {\n    const command =\n      packageManager === \"npm\"\n        ? [\"npx\", \"shadcn@latest\", \"init\"]\n        : [packageManager, \"dlx\", \"shadcn@latest\", \"init\"];\n\n    await execa(command[0], command.slice(1), {\n      cwd,\n      stdio: \"inherit\",\n      shell: true,\n    });\n  } catch (error) {\n    handleError(error);\n  }\n}\n","import { initOptionSchema } from \"@/src/commands/init\";\nimport { existsSync } from \"fs\";\nimport fs from \"fs-extra\";\nimport path from \"path\";\nimport { z } from \"zod\";\nimport { logger } from \"../logging/logger\";\n\nexport type PayloadAppDetails = {\n  isSrcDir: boolean;\n  isSupportedPayloadVersion: boolean;\n  payloadVersion: string | null;\n};\n\nconst MINIMUM_MAJOR_VERSION = 3;\nconst SUPPORTED_SPECIAL_VERSIONS = [\"latest\"];\n\nexport async function preFlightInit(\n  options: z.infer<typeof initOptionSchema>,\n) {}\n\n//Default check for project\nexport const checkProjectSetUp = async (projectDir: string) => {\n  const isPayloadPresents = existsSync(\n    path.resolve(projectDir, \"src/payload.config.ts\"),\n  );\n  return isPayloadPresents;\n};\n\nexport const checkShadcnPresents = async (projectDir: string) => {\n  const isShadcnPresents = existsSync(\n    path.resolve(projectDir, \"components.json\"),\n  );\n  return isShadcnPresents;\n};\n\nexport const getPayloadAppDetails = async (\n  projectDir: string,\n): Promise<PayloadAppDetails> => {\n  const isSrcDir = existsSync(path.resolve(projectDir, \"src\"));\n  const packageObj = await fs.readJson(\n    path.resolve(projectDir, \"package.json\"),\n  );\n  const payloadVersion = packageObj.dependencies?.payload ?? null;\n\n  if (!payloadVersion) {\n    return createPayloadDetails(isSrcDir, false, null);\n  }\n\n  const versionMatch = payloadVersion.match(\n    /^(?:(?<major>\\d+)|(?<special>latest|beta))$/i,\n  );\n\n  if (!versionMatch) {\n    logger.warn(`Could not determine payload version from ${payloadVersion}`);\n    return createPayloadDetails(isSrcDir, false, payloadVersion);\n  }\n\n  const { special, major } = versionMatch.groups;\n  const isSupported = isVersionSupported(special, major);\n\n  if (!isSupported) {\n    logger.warn(\n      `Unsupported payload version ${payloadVersion}. Version must be latest or >= ${MINIMUM_MAJOR_VERSION}.0.0`,\n    );\n  }\n\n  return createPayloadDetails(isSrcDir, isSupported, payloadVersion);\n};\n\nconst isVersionSupported = (special?: string, major?: string): boolean => {\n  if (special) {\n    return SUPPORTED_SPECIAL_VERSIONS.includes(special.toLowerCase());\n  }\n  return major ? parseInt(major) >= MINIMUM_MAJOR_VERSION : false;\n};\n\nconst createPayloadDetails = (\n  isSrcDir: boolean,\n  isSupportedPayloadVersion: boolean,\n  payloadVersion: string | null,\n): PayloadAppDetails => ({\n  isSrcDir,\n  isSupportedPayloadVersion,\n  payloadVersion,\n});\n"],"mappings":"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","names":["Command","package_default","Command","path","z","red","white","green","yellow","loggingColor","logger","args","z","z","registryFileSchemaType","registryItemFileSchema","registryItemSchema","registryIndexFileItem","registryIndexItem","registryIndexSchema","filterComponentsResultSchema","z","registryIndexSchema","filterRequestedComponents","registry","requestedComponents","result","requested","component","item","path","z","handleError","error","logger","z","key","value","loggingColor","handle_error_default","REGISTRY_URL","getRegistryIndex","result","fetchRegistry","registryIndexSchema","logger","handle_error_default","path","getRegistryUrl","e","replaceExtensionWithJson","filePath","parsedPath","resolveRegistryDependencies","items","registryIndex","resolved","result","resolveDependencies","item","depName","dependency","reg","path","fse","execa","getPackageManager","args","options","projectDir","detected","commandExists","command","ora","spinner","text","options","fse","prompts","execa","addDependencies","cwd","dependencies","dependenciesSpinner","spinner","packageManager","getPackageManager","flag","isUsingReact19","logger","confirmation","packageJsonPath","path","packageJson","fse","existsSync","fs","path","basename","prompts","getFileContent","file","logger","result","fetchRegistry","content","registryItemSchema","error","handle_error_default","addFiles","options","files","config","filesCreated","filesUpdated","filesSkipped","addFileSpinner","spinner","fileName","basename","loggingColor","targetDir","path","targetPath","existsSync","overwrite","prompts","fs","relativePath","f","path","fs","CONFIG_FILE","createConfig","cwd","config","defaultConfig","getConfig","checkInitialized","addComponents","components","options","registryInfo","getRegistryIndex","logger","found","notFound","filterRequestedComponents","config","getConfig","itemsToRegister","resolveRegistryDependencies","addDependencies","item","dep","addFiles","existsSync","path","preFlightAdd","options","existsSync","path","logger","addOptionsSchema","z","add","Command","comp","opt","options","path","checkInitialized","logger","preFlightAdd","addComponents","error","add_default","Command","prompts","z","execa","initShadcn","cwd","packageManager","command","execa","error","handle_error_default","existsSync","fs","path","MINIMUM_MAJOR_VERSION","SUPPORTED_SPECIAL_VERSIONS","checkProjectSetUp","projectDir","existsSync","path","checkShadcnPresents","getPayloadAppDetails","isSrcDir","payloadVersion","fs","createPayloadDetails","versionMatch","logger","special","major","isSupported","isVersionSupported","MINIMUM_MAJOR_VERSION","SUPPORTED_SPECIAL_VERSIONS","isSupportedPayloadVersion","initOptionSchema","z","init","Command","o","options","payloadCheckSpinner","spinner","isPayloadPresents","checkProjectSetUp","isShadcnPresentInitialized","logger","loggingColor","getPayloadAppDetails","packageManager","getPackageManager","checkShadcnPresents","proceed","prompts","initShadcn","CONFIG_FILE","componentSpinner","createConfig","defaultConfig","e","handle_error_default","main","program","Command","package_default","add_default","init"]}